<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>People • Stanfield Lab</title>
  <meta name="description" content="Stanfield Lab at LSU SVM: Viral oncology and guinea-pig models of virus-associated cancers.">
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <style>
    :root {
      --primary-blue: #0ea5e9;
      --primary-green: #10b981;
      --text-dark: #0f172a;
      --text-muted: #64748b;
      --bg-light: #f8fafc;
      --bg-card: #ffffff;
      --border-color: #e2e8f0;
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      --accent-orange: #f59e0b;
      --accent-purple: #8b5cf6;
    }

    * { box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: var(--text-dark);
      background-color: var(--bg-light);
      margin: 0;
      padding: 0;
    }

    .skip-link {
      position: absolute;
      top: -40px;
      left: 6px;
      background: var(--primary-blue);
      color: white;
      padding: 8px;
      text-decoration: none;
      border-radius: 0 0 4px 4px;
      z-index: 2000;
    }

    .skip-link:focus { top: 0; }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .site-header {
      background: var(--bg-card);
      border-bottom: 1px solid var(--border-color);
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-wrap {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
    }

    .brand {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: var(--text-dark);
      font-weight: 700;
      font-size: 1.25rem;
    }

    .brand-img { height: 40px; margin-right: 0.5rem; }

    nav { display: flex; align-items: center; }

    .nav-toggle {
      display: none;
      background: none;
      border: 2px solid var(--border-color);
      border-radius: 0.5rem;
      padding: 0.5rem;
      cursor: pointer;
      font-size: 1rem;
      color: var(--text-dark);
    }

    .nav-list {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
      gap: 2rem;
    }

    .nav-list a {
      text-decoration: none;
      color: var(--text-dark);
      font-weight: 500;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      transition: all 0.2s;
    }

    .nav-list a:hover,
    .nav-list a[aria-current="page"] {
      background-color: var(--bg-light);
      color: var(--primary-blue);
    }

    .theme-toggle {
      background: none;
      border: 1px solid var(--border-color);
      border-radius: 0.5rem;
      padding: 0.5rem;
      margin-left: 1rem;
      cursor: pointer;
      font-size: 1.2rem;
      color: var(--text-muted);
      transition: all 0.2s;
    }

    .theme-toggle:hover {
      background-color: var(--bg-light);
      color: var(--text-dark);
    }

    main { 
      padding: 3rem 0;
    }

    h1 {
      font-size: 3rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 1rem;
      text-align: center;
    }

    .page-intro {
      text-align: center;
      font-size: 1.25rem;
      color: var(--text-muted);
      max-width: 600px;
      margin: 0 auto 3rem;
      line-height: 1.7;
    }

    .pub-toolbar {
      background: var(--bg-card);
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: var(--shadow-md);
      margin-bottom: 2rem;
      border: 1px solid var(--border-color);
    }

    .toolbar-content {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }

    .search-wrapper {
      position: relative;
      flex: 1;
      min-width: 250px;
    }

    .search-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      pointer-events: none;
    }

    #peopleSearch {
      width: 100%;
      padding: 0.875rem 1rem 0.875rem 3rem;
      border: 2px solid var(--border-color);
      border-radius: 0.75rem;
      font-size: 1rem;
      background: var(--bg-light);
      transition: all 0.2s;
    }

    #peopleSearch:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgb(14 165 233 / 0.1);
    }

    #roleFilter {
      padding: 0.875rem 1rem;
      border: 2px solid var(--border-color);
      border-radius: 0.75rem;
      font-size: 1rem;
      background: var(--bg-card);
      cursor: pointer;
      min-width: 150px;
      transition: all 0.2s;
    }

    #roleFilter:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgb(14 165 233 / 0.1);
    }

    .cards-people {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    }

    .card.person {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .card.person::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-blue), var(--primary-green));
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
    }

    .card.person:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 10px 10px -5px rgb(0 0 0 / 0.04);
    }

    .card.person:hover::before {
      transform: scaleX(1);
    }

    .person-photo {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 50%;
      display: block;
      margin: 0 auto 1.5rem;
      border: 4px solid var(--bg-light);
      box-shadow: 0 8px 16px rgb(0 0 0 / 0.1);
      transition: all 0.3s ease;
    }

    .card.person:hover .person-photo {
      transform: scale(1.05);
      box-shadow: 0 12px 20px rgb(0 0 0 / 0.15);
    }

    .person-body { 
      text-align: center; 
    }

    .person-name { 
      margin: 0 0 0.5rem; 
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-dark);
    }

    .person-role { 
      margin: 0 0 1rem; 
      font-size: 1rem; 
      color: var(--primary-blue);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .person-email { 
      margin: 0 0 1rem; 
      font-size: 0.95rem; 
    }

    .person-email a {
      color: var(--text-muted);
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      background: var(--bg-light);
      transition: all 0.2s;
      display: inline-block;
    }

    .person-email a:hover {
      background: var(--primary-blue);
      color: white;
    }

    .person-links { 
      margin: 0; 
      font-size: 0.9rem; 
    }

    .person-links a {
      color: var(--text-muted);
      text-decoration: none;
      margin: 0 0.5rem;
      padding: 0.5rem 0.75rem;
      border-radius: 0.5rem;
      background: var(--bg-light);
      transition: all 0.2s;
      display: inline-block;
      margin-bottom: 0.5rem;
    }

    .person-links a:hover {
      background: var(--primary-green);
      color: white;
      transform: translateY(-2px);
    }

    .muted {
      text-align: center;
      color: var(--text-muted);
      font-size: 1.25rem;
      padding: 3rem;
      background: var(--bg-card);
      border-radius: 1rem;
      border: 2px dashed var(--border-color);
    }

    .error {
      background: #fee2e2;
      color: #dc2626;
      padding: 1rem;
      border-radius: 0.5rem;
      border: 1px solid #fecaca;
    }

    .site-footer {
      background: var(--text-dark);
      color: white;
      padding: 3rem 0 1rem;
      margin-top: 4rem;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .footer-brand {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .footer-logo { height: 50px; }

    .footer-brand h3 {
      margin: 0 0 0.5rem;
      color: var(--primary-blue);
      font-size: 1.5rem;
    }

    .footer-brand p {
      margin: 0;
      color: #cbd5e1;
      font-size: 0.95rem;
    }

    .footer-grid h4 {
      color: var(--primary-green);
      margin-bottom: 1rem;
      font-size: 1.25rem;
    }

    .footer-grid a {
      color: #cbd5e1;
      text-decoration: none;
      transition: color 0.2s;
    }

    .footer-grid a:hover {
      color: var(--primary-blue);
    }

    .footer-bottom {
      border-top: 1px solid #334155;
      padding-top: 2rem;
      text-align: center;
      color: #94a3b8;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .nav-toggle {
        display: block;
      }

      .nav-list {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--bg-card);
        border-top: 1px solid var(--border-color);
        flex-direction: column;
        gap: 0;
        transform: translateY(-100vh);
        opacity: 0;
        transition: all 0.3s ease;
      }

      .nav-list[data-visible="true"] {
        transform: translateY(0);
        opacity: 1;
      }

      .nav-list a {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
      }

      h1 { 
        font-size: 2.5rem; 
        margin-bottom: 2rem;
      }

      .page-intro { 
        font-size: 1.1rem; 
        margin-bottom: 2rem;
      }

      .toolbar-content {
        flex-direction: column;
        align-items: stretch;
      }

      .search-wrapper {
        min-width: auto;
      }

      .cards-people {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }

      .footer-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
        text-align: center;
      }

      .footer-brand {
        justify-content: center;
      }
    }

    @media (max-width: 480px) {
      .header-wrap {
        padding: 0.75rem;
      }

      .container {
        padding: 0 0.75rem;
      }

      main {
        padding: 2rem 0;
      }

      h1 {
        font-size: 2rem;
      }

      .pub-toolbar {
        padding: 1.5rem;
      }

      .card.person {
        padding: 1.5rem;
      }
    }

    /* Dark mode support */
    @media (prefers-color-scheme: dark) {
      :root {
        --text-dark: #f1f5f9;
        --text-muted: #cbd5e1;
        --bg-light: #0f172a;
        --bg-card: #1e293b;
        --border-color: #334155;
      }
    }

    /* Focus styles for accessibility */
    button:focus,
    input:focus,
    select:focus {
      outline: 2px solid var(--primary-blue);
      outline-offset: 2px;
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header" role="banner">
    <div class="container header-wrap">
      <a class="brand" href="index.html" aria-label="Stanfield Lab home">
        <img src="assets/stanfield-lab-logo.svg" alt="Stanfield Lab" class="brand-img">
      </a>
      <nav aria-label="Primary">
        <button id="navToggle" class="nav-toggle" aria-expanded="false" aria-controls="primaryNav">Menu</button>
        <ul id="primaryNav" class="nav-list">
          <li><a href="index.html">Home</a></li>
          <li><a href="research.html">Research</a></li>
          <li><a href="people.html" aria-current="page">People</a></li>
          <li><a href="publications.html">Publications</a></li>
          <li><a href="news.html">News</a></li>
          <li><a href="opportunities.html">Opportunities</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
      <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">◐</button>
    </div>
  </header>

  <main id="main" class="container">
    <h1>People</h1>
    
    <p class="page-intro">
      Meet the dedicated researchers and scientists driving innovation in viral oncology and translational immunology at Stanfield Lab. Our diverse team combines expertise in veterinary medicine, molecular biology, and cancer research to advance guinea pig models for preclinical studies.
    </p>

    <div class="pub-toolbar">
      <div class="toolbar-content">
        <div class="search-wrapper">
          <div class="search-icon">🔍</div>
          <input id="peopleSearch" type="search" placeholder="Search by name, role, or expertise…" aria-label="Search people">
        </div>
        <select id="roleFilter" aria-label="Filter by role"></select>
      </div>
    </div>

    <div id="peopleGrid" class="cards-people" aria-live="polite"></div>

    <script>
      async function loadPeople() {
        const grid = document.getElementById('peopleGrid');
        const searchInput = document.getElementById('peopleSearch');
        const roleFilter = document.getElementById('roleFilter');
        let people = [];

        function showError(msg) {
          grid.innerHTML = `<p class="error">${msg}</p>`;
        }

        try {
          const res = await fetch('assets/people.json?v=' + Date.now(), { cache: 'no-store' });
          if (!res.ok) throw new Error(`HTTP ${res.status} loading people.json`);
          const text = await res.text();

          if (text.trim().startsWith('<')) {
            throw new Error('Expected JSON but received HTML (check path or 404).');
          }

          const data = JSON.parse(text);
          const raw = Array.isArray(data) ? data
                    : (Array.isArray(data.people) ? data.people : null);
          if (!raw) throw new Error('people.json must be an array or { "people": [...] }.');

          people = raw.map((p, i) => {
            if (!p || typeof p !== 'object') {
              console.warn('Bad entry at index', i, p);
              return { name: '', role: '', email: '' };
            }
            return {
              name: p.name || '',
              role: p.role || '',
              email: p.email || '',
              photo: p.photo || '',
              website: p.website || '',
              scholar: p.scholar || '',
              github: p.github || '',
              twitter: p.twitter || '',
              linkedin: p.linkedin || ''
            };
          });

          const bad = people.findIndex(p => !p.name);
          if (bad !== -1) console.warn('Entry missing "name" at index', bad, raw[bad]);

          const isPI = r => /prof|pi|director|principal/i.test(r);
          people.sort((a, b) => {
            const aPI = isPI(a.role), bPI = isPI(b.role);
            if (aPI !== bPI) return aPI ? -1 : 1;
            const roleCmp = (a.role || '').localeCompare(b.role || '');
            return roleCmp !== 0 ? roleCmp : (a.name || '').localeCompare(b.name || '');
          });

        } catch (err) {
          console.error(err);
          showError('Could not load people: ' + err.message);
          return;
        }

        const roles = Array.from(new Set(people.map(p => p.role).filter(Boolean))).sort((a,b)=>a.localeCompare(b));
        roleFilter.innerHTML = '<option value="">All roles</option>' + roles.map(r => `<option value="${r}">${r}</option>`).join('');

        function linkIcon(href, label, icon) {
          if (!href) return '';
          const safe = String(href);
          return `<a href="${safe}" target="_blank" rel="noopener" aria-label="${label} link" title="${label}">${icon || label}</a>`;
        }

        function formatCard(p) {
          const photo = p.photo ? `<img class="person-photo" src="${p.photo}" alt="Photo of ${p.name}" loading="lazy">` : 
                       `<div class="person-photo" style="background: linear-gradient(135deg, var(--primary-blue), var(--primary-green)); display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; color: white;">${p.name.split(' ').map(n => n[0]).join('').toUpperCase()}</div>`;
          
          const links = [
            p.website && linkIcon(p.website, 'Website', '🌐'),
            p.scholar && linkIcon(p.scholar, 'Google Scholar', '🎓'),
            p.github && linkIcon(p.github, 'GitHub', '💻'),
            p.twitter && linkIcon(p.twitter, 'Twitter', '🐦'),
            p.linkedin && linkIcon(p.linkedin, 'LinkedIn', '💼')
          ].filter(Boolean).join(' ');

          return `
            <article class="card person">
              ${photo}
              <div class="person-body">
                <h3 class="person-name">${p.name}</h3>
                <p class="person-role">${p.role}</p>
                ${p.email ? `<p class="person-email"><a href="mailto:${p.email}" title="Send email to ${p.name}">${p.email}</a></p>` : ''}
                ${links ? `<p class="person-links">${links}</p>` : ''}
              </div>
            </article>
          `;
        }

        function render(list) {
          if (list.length === 0) {
            grid.innerHTML = '<p class="muted">No people match your current search criteria. Try adjusting your filters.</p>';
          } else {
            grid.innerHTML = list.map(formatCard).join('');
          }
        }

        function filterAndRender() {
          const q = searchInput.value.trim().toLowerCase();
          const role = roleFilter.value;
          let filtered = people;
          
          if (role) {
            filtered = filtered.filter(p => p.role === role);
          }
          
          if (q) {
            filtered = filtered.filter(p =>
              (p.name && p.name.toLowerCase().includes(q)) ||
              (p.role && p.role.toLowerCase().includes(q)) ||
              (p.email && p.email.toLowerCase().includes(q))
            );
          }
          
          render(filtered);
        }

        searchInput.addEventListener('input', filterAndRender);
        roleFilter.addEventListener('change', filterAndRender);

        render(people);
      }

      // Mobile navigation
      document.addEventListener('DOMContentLoaded', () => {
        loadPeople();
        
        const navToggle = document.getElementById('navToggle');
        const primaryNav = document.getElementById('primaryNav');

        if (navToggle && primaryNav) {
          navToggle.addEventListener('click', () => {
            const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
            navToggle.setAttribute('aria-expanded', (!isExpanded).toString());
            primaryNav.setAttribute('data-visible', (!isExpanded).toString());
          });
        }

        // Theme toggle (placeholder functionality)
        const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
          themeToggle.addEventListener('click', () => {
            // Theme toggle logic would go here
            console.log('Theme toggle clicked');
          });
        }

        // Year update for footer
        const yearSpan = document.getElementById('year');
        if (yearSpan) {
          yearSpan.textContent = new Date().getFullYear();
        }
      });
    </script>
  </main>

  <footer class="site-footer" role="contentinfo">
    <div class="container footer-grid">
      <div class="footer-brand">
        <img src="assets/stanfield-lab-icon.svg" alt="Stanfield Lab icon" class="footer-logo">
        <div>
          <h3>Stanfield Lab</h3>
          <p>Viral Oncology • Small-Animal Models • Translational Immunology</p>
        </div>
      </div>
      <div>
        <h4>Find us</h4>
        <p>
          <a href="https://www.lsu.edu/vetmed/index.php" target="_blank" rel="noopener">LSU School of Veterinary Medicine</a><br>
          Baton Rouge, LA 70803
        </p>
      </div>
      <div>
        <h4>Contact</h4>
        <p><a href="mailto:bstanf5@lsu.edu">bstanf5@lsu.edu</a></p>
      </div>
    </div>
    <div class="container footer-bottom">
      <p>© <span id="year">2024</span> Stanfield Lab • LSU SVM</p>
    </div>
  </footer>

</body>
</html>
